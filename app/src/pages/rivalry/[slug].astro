---
import Layout from '../../layouts/Layout.astro';
import RivalryHero from '../../components/RivalryHero.astro';
import { getAllRivalries, generateSlug } from '../../lib/rivalry';
import type { RivalryData } from '../../lib/types';

export async function getStaticPaths() {
  const rivalries = await getAllRivalries();
  
  return rivalries.map((rivalry) => ({
    params: { 
      slug: generateSlug(rivalry.entity1.label, rivalry.entity2.label) 
    },
    props: { rivalry },
  }));
}

interface Props {
  rivalry: RivalryData;
}

const { rivalry } = Astro.props;
const { entity1, entity2, rivalry_period_start, rivalry_period_end } = rivalry;
---

<Layout>
  <main class="min-h-screen bg-white">
    <!-- Hero Section with Scrollytelling Animation -->
    <RivalryHero 
      entity1={entity1} 
      entity2={entity2} 
      rivalryStart={rivalry_period_start}
      rivalryEnd={rivalry_period_end}
    />

    <!-- Content Section (Placeholder for now) -->
    <div class="relative z-0 container mx-auto px-4 py-12 max-w-prose">
      <div class="mb-6">
        <a href="/" class="text-blue-600 hover:text-blue-800 text-sm font-medium">
          &larr; Back to all rivalries
        </a>
      </div>

      <h2 class="text-2xl font-bold mb-4 mt-8">Summary</h2>
      <p class="text-lg text-gray-700 leading-relaxed mb-12">
        {rivalry.summary}
      </p>

      <div class="border-t border-gray-200 pt-8">
        <h3 class="text-xl font-semibold mb-4">Timeline (Coming Soon)</h3>
        <p class="text-gray-500 italic">
          Vertical event feed will be implemented here.
        </p>
        
        <!-- Debug Data (Hidden for now, can be enabled if needed) -->
        <!-- 
        <pre class="mt-8 text-xs overflow-auto bg-gray-50 p-4 border rounded">
          {JSON.stringify(rivalry, null, 2)}
        </pre> 
        -->
      </div>
    </div>
  </main>
</Layout>
